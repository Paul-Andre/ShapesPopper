function createParticleSystem(){function t(t,e,i,n,r,s,l,c){var f;return h.length?(f=h.pop(),f.x=t,f.y=e,f.vx=i,f.vy=n,f.color=l,f.life=r,f.size=c,f.gravity=s):f=new a(t,e,i,n,r,s,l,c),o.push(f),f}function e(t){h.push(t)}function a(t,e,a,i,n,r,o,h){this.x=t,this.y=e,this.vx=a,this.vy=i,this.size=h,this.color=o,this.life=n,this.gravity=r}function i(t){for(var a=0;a<o.length;a++)o[a].update(t)&&(e(o[a]),o.splice(a,1),a--)}function n(t){for(var e=0;e<o.length;e++)o[e].draw(t)}function r(e,a,i,n,r,o){for(var h=0;30>h;h++){var s=2*Math.random()*Math.PI;t(e+n*Math.random(),a+n*Math.random(),Math.cos(s)*i,Math.sin(s)*i,.5*r+.5*r*Math.random(),50,o,4)}}var o=[],h=[];return a.prototype.draw=function(t){t.save(),t.fillStyle=this.color,t.fillRect(this.x,this.y,this.size,this.size),t.restore()},a.prototype.update=function(t){return this.vy+=this.gravity*t/100,this.x+=this.vx*t/100,this.y+=this.vy*t/100,this.life-=t,this.life<=0?!0:!1},{makeParticle:t,update:i,draw:n,burst:r}}