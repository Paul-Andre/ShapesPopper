function createParticleSystem(){function t(t,e,i,n,r,o,l,c,f){var u;return s.length?(u=s.pop(),u.x=t,u.y=e,u.vx=i,u.vy=n,u.color=l,u.life=r,u.size=c,u.gravity=o,u.sizeDim=f):u=new a(t,e,i,n,r,o,l,c,f),h.push(u),u}function e(t){s.push(t)}function a(t,e,a,i,n,r,o,h,s){this.x=t,this.y=e,this.vx=a,this.vy=i,this.size=h,this.color=o,this.life=n,this.gravity=r,this.sizeDim=s}function i(t){for(var a=0;a<h.length;a++)h[a].update(t)&&(e(h[a]),h.splice(a,1),a--)}function n(t){for(var e=0;e<h.length;e++)h[e].draw(t)}function r(e,a,i,n,r,o){for(var h=0;20>h;h++){var s=2*Math.random()*Math.PI;t(e+n*Math.random(),a+n*Math.random(),Math.cos(s)*i,Math.sin(s)*i,.5*r+.5*r*Math.random(),50,o,1.5*5*Math.random(),.9+.5*Math.random())}}function o(e,a,i,n,r,o){for(var h=0;100>h;h++){var s=2*Math.random()*Math.PI;t(e+n*Math.random(),a+n*Math.random(),Math.cos(s)*i,Math.sin(s)*i*Math.random(),.5*r+.5*r*Math.random(),10,o(Math.random()),5*5*Math.random(),1.9+.5*Math.random())}}var h=[],s=[];return a.prototype.draw=function(t){t.save(),t.fillStyle=this.color,t.fillRect(this.x,this.y,this.size,this.size),t.restore()},a.prototype.update=function(t){return this.vy+=this.gravity*t/100,this.x+=this.vx*t/100,this.y+=this.vy*t/100,this.size-=this.sizeDim*t/100,this.life-=t,this.life<=0||this.size<=0?!0:!1},{makeParticle:t,update:i,draw:n,burst:r,explode:o}}