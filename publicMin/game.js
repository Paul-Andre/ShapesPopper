function makeNewPopperGame(t,i,h){function r(){var t;return c.length>0?(t=c.pop(),t.t.forEachSet(function(){return 0})):t={x:0,y:0,t:new binaryData.Array(f,8,!1),h:0,v:0},l.push(t),t}function e(t){c.push(t)}function a(){var t=r();t.x=Math.floor(Math.random()*s),t.h=Math.floor(6*Math.random())+1,t.y=t.h*-h-h,t.t.forEachSet(function(){return Math.floor(4*Math.random()+2)},0,t.h)}var n={grid:new binaryData.Grid(t,i,8,!1),size:h},o=n.grid,s=t,f=i;console.log(o);var l=[],c=[];return n.chains=l,n.grid.forEachSet(function(){return Math.floor(4*Math.random()+2)},0,f-5,s),setInterval(a,10),n.draw=function(){var t=this.size;this.grid.forEach(function(i,h,r){i>1&&ctx.drawImage(tiles[i],h*t*ratio,r*t*ratio,t*ratio,t*ratio)}),l.forEach(function(i){i.t.forEach(function(h,r){h>1&&ctx.drawImage(tiles[h],i.x*t*ratio,(r*t+i.y)*ratio)})})},n.update=function(t){for(var i=0;i<l.length;i++){var r=l[i];r.v=Math.min(.5*h,r.v+.0625*h*t),r.y+=.125*r.v*t,o.get(r.x,Math.floor((r.y+r.h*h)/h))&&(r.t.forEach(function(t,i,e){t&&(o.set(r.x,i+Math.floor(r.y/h),t),e.set(i,0))}),e(r),l.splice(i,1),i--)}},n.usedChains=c,n.chains=l,n}